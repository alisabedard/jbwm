Problems and ideas follow:

Use C99 semantics where possible.
!!Would love others to test this and help out.!!
Too much preprocessor goop.
Too many choices for compile time.
Too many globals.

